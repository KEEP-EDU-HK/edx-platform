## mako

<%page expression_filter="h" args="online_help_token"/>

<%namespace name='static' file='../static_content.html'/>
<%namespace file='../main.html' import="login_query"/>
<%!
from django.core.urlresolvers import reverse
from django.utils.translation import ugettext as _

from lms.djangoapps.ccx.overrides import get_current_ccx
from openedx.core.djangolib.markup import HTML, Text

# App that handles subdomain specific branding
from branding import api as branding_api
# app that handles site status messages
from status.status import get_site_status_msg
from openedx.core.djangoapps.lang_pref.api import header_language_selector_is_enabled, released_languages
from openedx.core.djangoapps.user_api.accounts.image_helpers import get_profile_image_urls_for_user
%>

## Provide a hook for themes to inject branding on top.
<%block name="navigation_top" />

## Add UI Toolkit components if using the Pattern Library
% if uses_pattern_library:
    <%block name="js_extra">
    <%static:require_module module_name="js/header_factory" class_name="HeaderFactory">
    HeaderFactory();
    </%static:require_module>
    </%block>
% endif

<%block>
<%
try:
    course_id = course.id
except:
    # can't figure out a better way to get at a possibly-defined course var
    course_id = None
site_status_msg = get_site_status_msg(course_id)
%>
</%block>
<link rel="stylesheet" type="text/css" href="${static.url('keep-ficus/css/vendors/font-awesome.css')}">
<link rel="stylesheet" type="text/css" href="${static.url('keep-ficus/keeplogo/keeplogo.css')}">
<link rel="stylesheet" type="text/css" href="${static.url('keep-ficus/css/keepmenu.css')}">
<link rel="stylesheet" type="text/css" href="${static.url('keep-ficus/css/keepfooter.css')}">
<link rel="stylesheet" type="text/css" href="${static.url('keep-ficus/css/custom.css')}">
<!--<script type="text/javascript" src="${static.url('keep-ficus/js/vendors/jquery.min.js')}"></script>-->
<script type="text/javascript" src="${static.url('keep-ficus/js/vendors/jquery.autocomplete.min.js')}"></script>
<script type="text/javascript" src="${static.url('keep-ficus/js/vendors/handlebars.min.js')}"></script>
<script type="text/javascript" src="${static.url('keep-ficus/js/keepmenu.js')}"></script>
<script type="text/javascript" src="${static.url('keep-ficus/js/keepfooter.js')}"></script>

<nav id="keepmenu"></nav>
    <script>

        var explore_course = { title: "Explore Courses", url: "https://course.keep.edu.hk/" };
    
        % if course:
          course_url = "/courses/${course.id}/info"
          explore_course = { title: "${course.display_number_with_default}: ${course.display_name_with_default}", url: course_url};
        % endif
    
        var menu = [explore_course];

        // When logined
		% if user.is_authenticated():
		  <%
		  self.real_user = getattr(user, 'real_user', user)
		  username = self.real_user.username
		  first_name = self.real_user.first_name
		  profile_image_url = get_profile_image_urls_for_user(self.real_user)['medium']
		  helpUrl = get_online_help_info(online_help_token)['doc_url']
		  %>
          keepmenu('KEEPCourse', menu, "${username}", 'loginUrl', 'logoutUrl', null, 'q', 'collection2', 'en', "${profile_image_url}", "${helpUrl}", "${first_name}");
        // When not logined
		% else:
          keepmenu('KEEPCourse', menu, '', 'loginUrl', 'logoutUrl', 'searchUrl');
		% endif
    </script>

<%include file="../help_modal.html"/>
